# 性能优化

CRP关键渲染路径

## 指标

-Performance接口可以获取到当前页面中与性能相关的内容。它是High Resolution Time API 的一部分

```js
  const timingInfo = window.performance.timing
  // TCP 连接耗时
  timingInfo.connectEnd - timingInfo.connectStart
  // DNS 查询耗时
  timingInfo.domainLookupEnd - timingInfo.domainLookupStart
  // 获取首字节耗时，也叫做TTFB
  timingInfo.responseStart - timingInfo.navigationStart
  // domReady时间
  timingInfo.domContentLoadedEventStart - timing.navigationStart

  // DOM资源下载的
  timingInfo.responseEnd - timingInfo.responseStart
```

## 优化

### 渲染阶段

DOM树
  标签语义化  
  避免多层嵌套
CSSOM树
  减少选择器层级
  less层级嵌套要慎用
  减少@import的使用，尽可能的使用link
  style样式不多的情况下可以使用style内嵌样式
避免阻塞的js的加载
  放在底部  script 标签里面要加defer(推荐) async
减少页面的回流
  减少dom的操作，比如使用vue/react框架
  分离读写
  样式集中改变
  缓存布局信息
  元素批量修改
  动画效果应用到时position属性为absolute或fixed(脱离文档流)
  css3硬件加速（GPU加速）
  牺牲平滑度换取速度
  避免table布局和使用css的js表达式

### DNS解析过程

减少DNS请求次数
DNS预获取（dns-prefetch）

### 减少HTTP请求次数和请求资源大小

资源合并压缩
字体图标
Base64
GZIP（一般的文件能压缩60%左右）
图片懒加载
数据延迟分批加载
CDN资源
应用缓存
