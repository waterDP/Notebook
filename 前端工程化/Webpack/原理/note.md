# webpack

## 打包流程

1.初始化参数：从配置文件和shell语句中读取与合并参数，得出最终的参数
2.初始化编译：用上一步得到的参数初始化Compiler对象，注册插件并传入Compiler实例（挂载了众多webpack事件api供插件调用）
3.AST&依赖图：用入口文件（entry）出发，调用AST引擎（acorn）生成抽象语法树AST，根据AST引擎（acorn）生成抽象语法树AST，根据AST构建模块的所有依赖。
4.递归编译模块：调用所有配置的Loader对模块进行编译
5.输出资源：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的Chunk，再把每个Chunk转换成一个单独的文件加入到输出列表，这步是可以修改内容的最后机会。
6.输出完成：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统



## webpack三种类型的hash
1.hash
hash是跟整个项目的构建相关，只要项目里有文件更改，整个项目构建的hash值都会更改，并且全部文件都共用相同的hash的值。
即使文件没有做“任何修改”，hash值也会改变，无法达到缓存的目的

2.chunkhash
chunkhash它根据不同的入口文件进行依赖文件解析、构建对应的chunk生成对应的哈希值
简单来说这种是根据不同入口来配置的，比如vue-router/vuex/vue等公共入口文件，只要这些没有改变，那么他对应生成的js的hash值也不会改变

3.contenthash
contenthash主要是处理关联性，比如一个js文件中引入css，但是会生成一个js文件，一个css文件，但是因为入口是一个，导致他们的hash值也相同，所以当只有js修改时，关联输入的css、img等文件的hash值，这种情况下就需要contenthash了